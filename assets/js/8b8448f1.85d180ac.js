"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[6439],{68626:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>d,frontMatter:()=>a,metadata:()=>r,toc:()=>o});var t=i(85893),s=i(11151);const a={title:"Tag 6",tags:["M122","Tag 6","Powershell","WMI","CIM"]},l="Tag 6: WMI und CIM",r={id:"M122/tag-0006",title:"Tag 6",description:"1 Windows Management Instrumentation (WMI)",source:"@site/docs/M122/tag-0006.md",sourceDirName:"M122",slug:"/M122/tag-0006",permalink:"/docs/M122/tag-0006",draft:!1,unlisted:!1,tags:[{label:"M122",permalink:"/docs/tags/m-122"},{label:"Tag 6",permalink:"/docs/tags/tag-6"},{label:"Powershell",permalink:"/docs/tags/powershell"},{label:"WMI",permalink:"/docs/tags/wmi"},{label:"CIM",permalink:"/docs/tags/cim"}],version:"current",frontMatter:{title:"Tag 6",tags:["M122","Tag 6","Powershell","WMI","CIM"]},sidebar:"tutorialSidebar",previous:{title:"Tag 5",permalink:"/docs/M122/tag-0005"},next:{title:"Tag 7",permalink:"/docs/M122/tag-0007"}},c={},o=[{value:"1 Windows Management Instrumentation (WMI)",id:"1-windows-management-instrumentation-wmi",level:2},{value:"2 \xdcbungen zu WMI",id:"2-\xfcbungen-zu-wmi",level:2}];function m(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",strong:"strong",...(0,s.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"tag-6-wmi-und-cim",children:"Tag 6: WMI und CIM"}),"\n",(0,t.jsx)(n.h2,{id:"1-windows-management-instrumentation-wmi",children:"1 Windows Management Instrumentation (WMI)"}),"\n",(0,t.jsxs)(n.p,{children:["WMI ist seit Windows 2000 ein Teil von Windows. Es kann genutzt werden, um fast alle Eigenschaften von einem Ger\xe4t (auch \xfcber Remote) herauszulesen. Powershell hat standardm\xe4ssig einen vollen WMI-Support. Um alle WMI-Commands auszulesen, kann das ",(0,t.jsx)(n.code,{children:"Get-Command"})," Cmdlet genutzt werden."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-powershell",children:"get-command -noun WMI*\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-powershell",metastring:"title='Output'",children:"CommandType     Name                                               Version    Source\n-----------     ----                                               -------    ------\nCmdlet          Get-WmiObject                                      3.1.0.0    Microsoft.PowerShell.Management\nCmdlet          Invoke-WmiMethod                                   3.1.0.0    Microsoft.PowerShell.Management\nCmdlet          Register-WmiEvent                                  3.1.0.0    Microsoft.PowerShell.Management\nCmdlet          Remove-WmiObject                                   3.1.0.0    Microsoft.PowerShell.Management\nCmdlet          Set-WmiInstance                                    3.1.0.0    Microsoft.PowerShell.Management\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Eine Alternative zu WMI ist Common Information Model (CIM). Es wurde in PowerShell v3.0 eingef\xfchrt. CIM kann auf Windows, sowie auf nicht-Windows Rechnern genutzt werden. Auch hier kann das Cmdlet ",(0,t.jsx)(n.code,{children:"Get-Command"})," genutzt werden um alle CIM-Commands anzuzeigen."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-powershell",children:"get-command -module cimcmdlets\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-powershell",metastring:"title='Output'",children:"CommandType     Name                                               Version    Source\n-----------     ----                                               -------    ------ \nCmdlet          Export-BinaryMiLog                                 1.0.0.0    cimcmdlets\nCmdlet          Get-CimAssociatedInstance                          1.0.0.0    cimcmdlets\nCmdlet          Get-CimClass                                       1.0.0.0    cimcmdlets\nCmdlet          Get-CimInstance                                    1.0.0.0    cimcmdlets\nCmdlet          Get-CimSession                                     1.0.0.0    cimcmdlets\nCmdlet          Import-BinaryMiLog                                 1.0.0.0    cimcmdlets\nCmdlet          Invoke-CimMethod                                   1.0.0.0    cimcmdlets\nCmdlet          New-CimInstance                                    1.0.0.0    cimcmdlets\nCmdlet          New-CimSession                                     1.0.0.0    cimcmdlets\nCmdlet          New-CimSessionOption                               1.0.0.0    cimcmdlets\nCmdlet          Register-CimIndicationEvent                        1.0.0.0    cimcmdlets\nCmdlet          Remove-CimInstance                                 1.0.0.0    cimcmdlets\nCmdlet          Remove-CimSession                                  1.0.0.0    cimcmdlets\nCmdlet          Set-CimInstance                                    1.0.0.0    cimcmdlets\n"})}),"\n",(0,t.jsx)(n.p,{children:"WMI und CIM k\xf6nnen auch mit SQL-Abfragen genutzt werden."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-powershell",children:"get-wmiobject -query 'select * from win32_bios'\n"})}),"\n",(0,t.jsx)(n.p,{children:"Allerdings kann auch das normale Powershell-Schema genutzt werden."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-powershell",children:"get-wmiobject win32_bios\n"})}),"\n",(0,t.jsx)(n.admonition,{title:"Alias get-wmiobject",type:"info",children:(0,t.jsxs)(n.p,{children:["Zum Cmdlet ",(0,t.jsx)(n.code,{children:"get-wmiobject"})," gibt es den Alias ",(0,t.jsx)(n.code,{children:"gwmi"})]})}),"\n",(0,t.jsx)(n.h2,{id:"2-\xfcbungen-zu-wmi",children:"2 \xdcbungen zu WMI"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schreiben Sie eine Funktion, welche die freie Diskkapazit\xe4t pro Disk in GB in einer Hashtable zur\xfcckgibt (Win32_LogicalDisk)."})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-powershell",children:"gwmi win32_logicaldisk | foreach {$_.name, ($_.freespace /1GB)}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schreiben Sie eine Funktion, welche die totale RAM-Kapazit\xe4t in GB zur\xfcckgibt (Win32_PhysicalMemory)."})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-powershell",children:"gwmi win32_physicalmemory | foreach {$_.capacity /1GB}\ngwmi win32_physicalmemory | foreach {$_.capacity /1GB} | measure -sum | foreach {$_.sum}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schreiben Sie eine Funktion, welche die freie RAM-Kapazit\xe4t zur\xfcckgibt (Win32_OperatingSystem)."})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-powershell",children:"gwmi win32_operatingsystem | foreach {$_.freephysicalmemory /1E+6}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schreiben Sie eine Funktion, welche alle lokalen Benutzer (Benutzernamen) in einem Array zur\xfcckgibt (Win32_UserAccount)."})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-powershell",children:"gwmi win32_useraccount | foreach {$_.name}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Schreiben Sie eine Funktion, welche Name und Pfad aller Freigaben zur\xfcckgibt."})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-powershell",children:"gwmi win32_share | select {$_.name, $_.path}\ngwmi win32_share | foreach {$_.name, $_.path}\n"})})]})}function d(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(m,{...e})}):m(e)}},11151:(e,n,i)=>{i.d(n,{Z:()=>r,a:()=>l});var t=i(67294);const s={},a=t.createContext(s);function l(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);