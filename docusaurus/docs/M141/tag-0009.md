---
title: "Tag 9"
tags:
  - M141
  - Tag 9
  - Datenbanksysteme
  - Performance
  - Indexing
---

# Tag 9

## 1 Dokumentationsaufträge

### 1.1 Kurzzusammenfassung zu den Performance Tips

#### 1.1.1 Attribute indexieren

##### 1.1.1.1 Problem

Alle Attribute die bei `WHERE`, `ORDER BY` und `GROUP BY` genutzt werden, sollten indexiert sein.  
[-> Tag 4 - Kapitel 2.1.4](./tag-0004.md#214-indexierung)

```sql
select customer_id, customer_name from customers where customer_id='140385';
```

Wird dieses Statement auf einer Datenbank mit 500 Datensätzen ausgeführt, werden alle Werte überprüft.

Mit einem `EXPLAIN` kann man überprüfen, was bei der Abfrage passiert.

```sql
explain select customer_id, customer_name from customers where customer_id='140385';
```

```sql title="OUTPUT"
+----+-------------+-----------+------------+------+---------------+------+---------+------+------+----------+-------------+
| id | select_type | table     | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |
+----+-------------+-----------+------------+------+---------------+------+---------+------+------+----------+-------------+
|  1 | SIMPLE      | customers | NULL       | ALL  | NULL          | NULL | NULL    | NULL |  500 |    10.00 | Using where |
+----+-------------+-----------+------------+------+---------------+------+---------+------+------+----------+-------------+
```

`key`: Ist der `key` auf `NULL`, ist das immer schlecht da er keinen key zum suchen nutzt.  
`rows`: Dieses Attribut zeigt wie viele Datensätze gesucht werden.

##### 1.1.1.2 Lösung

Index erstellen

```sql
Create index customer_id ON customers (customer_Id);
```

Abfrage per `EXPLAIN` überprüfen

```sql
Explain select customer_id, customer_name from customers where customer_id='140385';
```

```sql title="OUTPUT"
+----+-------------+-----------+------------+------+---------------+-------------+---------+-------+------+----------+-------+
| id | select_type | table     | partitions | type | possible_keys | key         | key_len | ref   | rows | filtered | Extra |
+----+-------------+-----------+------------+------+---------------+-------------+---------+-------+------+----------+-------+
|  1 | SIMPLE      | customers | NULL       | ref  | customer_id   | customer_id | 13      | const |    1 |   100.00 | NULL  |
+----+-------------+-----------+------------+------+---------------+-------------+---------+-------+------+----------+-------+
```

Da jetzt ein `key` existiert und dieser genutzt wird, wird nicht mehr `NULL` angezeigt. Auch kann man sehen, dass bei `rows` nur noch ein Datensatz gesucht wird, da er nach der `customer_id` suchen kann.

#### 1.1.2 `UNIONS` verwenden

Wenn bei einem `WHERE`-Statement mit `OR` gearbeitet werden muss, sollte ein `UNION` genutzt werden. Dieser kombiniert die Resultate von mehreren `SELECTS`.

### 1.2 Übungsdokumentation zu Performance und Indexing
