---
title: "Tag 11"
tags:
  - M141
  - Tag 11
  - MongoDB
  - Erste Schritte
---

# Tag 11

## 1 Dokumentationsaufträge

### 1.1 Dokumentation zur Übung "Erste Schritte mit MongoDB"

#### 1.1.1 Starten und nutzen des Shell-Clients

Um mit MongoDB im Terminal zu arbeiten muss der Befehl `mongosh` (ab Version 5.0, davor nur `mongo`) ausgeführt werden. Mit dem Ausführen des Befehls wird eine lokale MongoDB-Instanz auf dem Port 27017 geöffnet.

Wichtige Parameter:

| Parameter               | Beschreibung                                       |
| ----------------------- | -------------------------------------------------- |
| `--nodb`                | Verhindert das Öffnen von Datenbanken in der Shell |
| `--port <port>`         | Port für Verbindung                                |
| `--host <host>`         | Host für Verbindung                                |
| `--help`                | Zeigt weitere Parameter und eine Beschreibung      |
| `--username <username>` | Mit angegebenen Benutzer anmelden                  |
| `--password <password>` | Passwort von angegeben Benutzer                    |

#### 1.1.2 Datenbank erstellen

Um eine Datenbank oder zu nutzen muss der Befehl `use` genutzt werden. MongoDB merjt selbst ob die Datenbank bereits besteht oder nicht. Besteht sie nicht, wird eine erstellt und falls sie bereits besteht wird die Datenbank genutzt. Standardmässig startet MongoDB immer in die `test`-DB. Somit ist es wichtig bevor man z.B. eine Collection erstellt, dass die richtige Datenbank ausgewählt ist.

```mongodb
use meinedatenbank
```

Der Befehl `db` zeigt die momentan genutzte Datenbank an.

#### 1.1.3 Collection erstellen

Nachdem eine Datenbank genutzt wird, kann eine Collection erstellt werden. Eine Collection ist mit einem Table zu vergleichen. In der Collection werden später JSON-Daten (die JSON Daten werden zu BSON-Daten umgewandelt -> binäres JSON) gespeichert.

```mongodb
db.createCollection("meinecollection")
```

#### 1.1.4 Dokumente erstellen

Um Dokumente zu erstellen, gibt es drei verschiedene Methoden

```mongodb
.insertOne()
.insertMany()
.insert()
```

- `.insertOne()`: fügt ein Dokument der Colletion hinzu
- `insertMany()`: fügt mehrere verschiedene Dokumente der Collection hinzu
- `insert()`: fügt ein oder mehrere Dokumente der Collection hinzu

Folgendes Beispiel fügt ein Dokument mit den Informationen Name, Alter und Geschlecht ein:

```mongodb
db.meinecollection.insertOne(
{
    Name: "Name",
    Alter: 28,
    Geschlecht: "männlich"
}
)
```

MongoDB erstellt für dieses Dokument automatisch eine `_id`. Diese ist einzigartig und kann daher zur Identifikation von Dokumenten genutzt werden.

#### 1.1.5 Dokumente verwalten

Um Dokumente zu verändern, müssen diese zuerst identifiziert werden. Dafür kann der Befehl `find()` genutzt werden. So kann das vorherige Beispiel wie folgt gefunden werden.

```mongodb
db.meinecollection.find( { Name: "Name", Alter: 28 } )
```

Um ein Dokument zu ändern, muss der Befehl `update()` genutzt werden. Für diesen Befehl muss als erstes Attribut den zu verändernden Wert angegeben werden. Das zweite Attribut ist der neue Wert. Zum neuen Attribut muss die Variable `$set` mitgegeben werden.

```mongodb
db.meinecollection.update(

{ Alter: 28 },

{

$set: { Alter: 30 }

}

)
```

Um Dokumente zu löschen, muss der Befehl `deleteOne` (bei Versionen älter als 5.0 heisst er `remove`) genutzt werden. Um etwas zu löschen, muss dem Befehl die Informationen mitgegeben werden. Ist eine Information in mehreren Dokumenten enthalten, werden alle diese Dokumente gelöscht. Daher umso präziser, desto bester (am Besten die `_id` nutzen). Folgendes Beispiel löscht alle Dokumente mit der Information Alter, welche auf 30 steht.

```mongodb
db.meinecollection.deleteOne ( { Alter: 30 } )
```

Um nur den ersten Eintrag mit der übereinstimmenden Information zu löschen, kann der `justOne`-Parameter mitgegeben werden.

```mongodb
db.meinecollection.deleteOne ( { Alter: 30 }, 1 )
```

Gute Cheat Sheets für MongoDB können auf der [offiziellen MongoDB-Seite](https://www.mongodb.com/developer/products/mongodb/cheat-sheet/) oder auf diesem [GitHub Gist](https://gist.github.com/bradtraversy/f407d642bdc3b31681bc7e56d95485b6) gefunden werden.
