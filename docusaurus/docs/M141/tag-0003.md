---
title: "Tag 3"
tags:
  - M141
  - Tag 3
  - Datenbanksysteme
  - MySQL Konfiguration
  - Storage-Engine
  - InnoDB
  - MyISAM
---

# Tag 3

## 1 Dokumentationsaufträge

### 1.1 Recherche zu MySQL (Versionen, usw.)

[Tag 2 - Kapitel 2.1.1](./tag-0002.md#211-recherche)

### 1.2 Recherche zur Installationsumgebung (OS, Kernel, etc)

[Tag 2 - Kapitel 2.1.2](./tag-0002.md#212-voraussetzungen-der-installation)

### 1.3 Dokumentation des Installationsprozesses

[Tag 2 - Kapitel 2.1.3](./tag-0002.md#213-prozess-der-installation)

### 1.4 Testing der Installation

[Tag 2 - Kapitel 2.1.4](./tag-0002.md#214-test-der-installation)

## 2 Übungen

### 2.1 Konfiguration eines RDBMS

#### 2.1.1 Storage Engines bei MySQL

**Recherche - Dokumentieren Sie ausführlich die 2 wichtigsten (nicht irgendwelche, die wichtigsten) Storage-Engines unter MySQL**

Die zwei wichtigsten Storage-Engines für MySQL sind "InnoDB" und "MyISAM".

InnoDB ist der Standard Storage-Engines für MySQL. Es ist ACID-fähig und ist dadurch für kritische Anwendungen geeignet. Es unterstützt Transaktionen, somit gibt es keinen inkonsistenten Zustand. Bei Schreibvorgängen wird nicht die ganze Tabelle, sondern nur der Datensatz gesperrt (Row-Level-Locking). InnoDB nutzt auch Fremdschlüssel-Constraints. Diese stellen sicher, dass Beziehungen zwischen Tabellen korrekt sind.

MyISAM bietet eine hohe Lesegeschwindigkeit und ist somit für Anwendungen mit vielen Lesevorgängen geeignet, z.B. Webseiten. Bei Schreibvorgängen wird die gesamte Tabelle gesperrt und ist somit nicht so effektiv.

**Recherche - Listen und beschreiben Sie kurz die restlichen Storage-Engines auf Ihrem System**

| SE | Beschreibung |
| --- | --- |
| Memory | Alle Daten werden im RAM gespeichert. Keine dauerhafte Speicherung. |
| CSV | Speichert die Daten im CSV-Format. Geeignet für Import und Export. |
| Archive | Bietet eine hohe Komprimierung. Eignet sich für Archivdaten. |
| Blackhole | Empfängt alle Schreibvorgänge, speichert diese allerdings nicht. |
| NDB | Geeignet für eine Cluster-Umgebung. Es ist gut skalierbar und hat eine hohe Verfügbarkeit. |
| Merge | MyISAM Tabellen zu einem kombinieren. Es ist somit eine virtuelle Tabelle |
| Federated | Bietet die Möglichkeit verteilte MySQL Server zu einer logischen Datenbank zu verbinden. |
| Example | Bietet Entwicklern einen einfachen Aufbau von Storage-Engines. |

**Überlegen Sie sich welche Daten mit welcher Storage Engine gespeichert werden könnten**

| SE        | Anwendung                          |
| --------- | ---------------------------------- |
| InnoDB    | anspruchsvolle Anwendungen         |
| MyISAM    | Webseiten/Suchmaschinen            |
| Memory    | temp. Daten (Cache & Session)      |
| CSV       | Import und Export von Daten        |
| Archive   | Archivierung von Daten             |
| Blackhole | Schreibvorgänge weiterleiten       |
| NDB       | Webanwendung mit mehreren Systemen |
| Merge     | Daten aus Tabellen zusammenfügen   |
| Federated | Remote Datenbanken zusammenfügen   |
| Example   | Testing für Entwickler             |

**Dokumentieren Sie wie eine Storage Engine auf eine Tabelle angewendet wird**

Um eine Storage Engine auf eine Tabelle anzuwenden muss nach einem `CREATE TABLE` die `ENGINE` angegeben werden.

```sql
CREATE TABLE users (
  id INT,
  username varchar(255)
) ENGINE=InnoDB;
```

#### 2.1.2 Benutzer und Berechtigungen

**Erstellen Sie eine Demo-Datenbank mit zwei Tabellen**

```sql
CREATE DATABASE demo_db;
USE demo_db;
CREATE TABLE tab1 (id int);
CREATE TABLE tab2 (id int);
```

**Root-Benutzer konfiguriert (Login/Passwort)**

```sql
ALTER USER 'root'@'localhost' IDENTIFIED BY 'MySQL_M141#';
FLUSH PRIVILEGES;
```

**Benutzer konfiguriert (Login/Passwort/Berechtigung auf Datenbank eingeschränkt <- ein Anwendungsbenutzer)**

```sql
CREATE USER 'm141_user'@'localhost' IDENTIFIED BY 'MySQL_M141#';
GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP ON demo_db.* TO 'm141_user'@'localhost';
FLUSH PRIVILEGES;
```

**Admin-Benutzer konfiguriert (Login/Passwort/Berechtigung auf Datenbank eingeschränkt)**

```sql
CREATE USER 'm141_admin'@'localhost' IDENTIFIED BY 'MySQL_M141#';
-- RELOAD und PROCESS sind GLOBAL PRIVILEGES. Diese können nicht auf Datenbanken gegeben werden.
GRANT RELOAD,PROCESS ON *.* TO 'm141_admin'@'localhost';
FLUSH PRIVILEGES;
```

**Verfizieren Sie Ihre Konfiguration und speichern Sie das Resultat in Ihrer Dokumentation**

```sql
SHOW GRANTS FOR 'm141_user'@'localhost';
SHOW GRANTS FOR 'm141_admin'@'localhost';
```

```sql title='OUTPUT'
mysql> SHOW GRANTS FOR 'm141_user'@'localhost';
+----------------------------------------------------------------------------------------------+
| Grants for m141_user@localhost                                                               |
+----------------------------------------------------------------------------------------------+
| GRANT USAGE ON *.* TO `m141_user`@`localhost`                                                |
| GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP ON `demo_db`.* TO `m141_user`@`localhost` |
+----------------------------------------------------------------------------------------------+
2 rows in set (0.00 sec)

mysql> SHOW GRANTS FOR 'm141_admin'@'localhost';
+----------------------------------------------------------+
| Grants for m141_admin@localhost                          |
+----------------------------------------------------------+
| GRANT RELOAD, PROCESS ON *.* TO `m141_admin`@`localhost` |
+----------------------------------------------------------+
1 row in set (0.00 sec)
```

#### 2.1.3 Server-Konfiguration

**Transaktions-Isolation : Verfizieren Sie welche Transaktions-Isolation auf Ihrem Server aktiviert ist. Dokumentieren Sie, was das bezüglich den Anomalien für Ihre Installation bedeutet.**

```sql
SHOW VARIABLES LIKE "transaction_isolation";
```

```sql title='OUTPUT'
mysql> SHOW VARIABLES LIKE "transaction_isolation";
+-----------------------+-----------------+
| Variable_name         | Value           |
+-----------------------+-----------------+
| transaction_isolation | REPEATABLE-READ |
+-----------------------+-----------------+
1 row in set (0.01 sec)
```

`REPEATABLE-READ` gewährleistet, dass die gleichen Daten bei wiederholten Lesevorgängen innerhalb der Transaktion konsistent bleiben. Phantom Reads sind möglich.

**Exportieren Sie die aktuelle Liste an System-Variablen**

```sql
-- Ausserhalb des MySQL Servers ausführen.
sudo mysql -u root -p -e "SHOW VARIABLES;" > ./Downloads/system_variables.txt
```

[OUTPUT](/appendix/M141/system-variables)

**Netzwerkkonfiguration DBMS-Server anpassen und dokumentieren (wie kann man einen TCP Port öffnen?)**

```text title='/etc/mysql/mysql.conf.d/mysqld.cnf'
...
port            = 33066
...
```

```text
sudo mysql -u root -p -P 33066
```

#### 2.1.4 Server-Betrieb

**Protokollierung langsamer Abfragen aktivieren**

```text title='/etc/mysql/mysql.conf.d/mysqld.cnf'
...
slow_query_log          = 1
slow_query_log_file     = /var/log/mysql/mysql-slow.log
...
```

**Listen Sie den Inhalt des Data-Directories auf**

```text title='/etc/mysql/mysql.conf.d/mysqld.cnf'
...
datadir         = /var/lib/mysql
...
```

```
sudo ls /var/lib/mysql
```

**Dokumentieren Sie die Default-Datenbanken mysql, sys, performance_schema**

mysql: Enthält systemrelevante Informationen, MySQL-Benutzerkonten und deren Zugriffsrechte. Sie ist für Verwaltung von Benutzerkonten und die Zugriffsrechte nötig.

sys: Diese Datenbank wirs automatisch erstellt und enthält Informationen über Speicher, CPU, Zugriffe usw. Es kann als Monitoring für das DBMS genutzt werden.

performance_schema: Detailliertere Informationen die für die Perfomance für das DBMS zuständig sind. Es kann verwendet werden um Abfragen zu analysieren.

Alle drei Datenbanken sind für MySQL essentiell und sollten nicht vom User bearbeitet oder gelöscht werden.

---

Quellen:

- https://dev.mysql.com/doc/
